@using WSyncPro.Models.Content
@using MudBlazor

<MudPaper Class="p-4">
    <MudTable Items="@SyncJobs" Dense="true" Hover="true">
        <HeaderContent>
            <MudTh>Name</MudTh>
            <MudTh>Status</MudTh>
            <MudTh>Source Directory</MudTh>
            <MudTh>Destination Directory</MudTh>
            <MudTh>Actions</MudTh>
        </HeaderContent>
        <RowTemplate Context="job">
            <MudTd>@job.Name</MudTd>
            <MudTd>@job.Status</MudTd>
            <MudTd>@job.SrcDirectory</MudTd>
            <MudTd>@job.DstDirectory</MudTd>
            <MudTd>
                <MudButton Variant="Variant.Outlined" Color="Color.Primary" OnClick="() => EditJob(job)">
                    Edit
                </MudButton>
                <MudButton Variant="Variant.Outlined" Color="Color.Error" OnClick="() => DeleteJob(job)">
                    Delete
                </MudButton>
            </MudTd>
        </RowTemplate>
    </MudTable>

    <MudDialog @bind-Open="ShowEditDialog">
        <SyncJobComponent SyncJob="@SelectedJob" Editable="true" />
    </MudDialog>
</MudPaper>

@code {
    [Parameter]
    public List<SyncJob> SyncJobs { get; set; } = new();

    private SyncJob SelectedJob { get; set; }
    private bool ShowEditDialog { get; set; }

    private void EditJob(SyncJob job)
    {
        SelectedJob = job;
        ShowEditDialog = true;
    }

    private void DeleteJob(SyncJob job)
    {
        SyncJobs.Remove(job);
    }
}
